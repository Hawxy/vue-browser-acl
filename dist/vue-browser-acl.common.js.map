{"version":3,"file":"vue-browser-acl.common.js","sources":["../node_modules/browser-acl/dist/browser-acl.esm.js","../index.js"],"sourcesContent":["function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t=\"GLOBAL_RULE\",r=function(e){return\"boolean\"==typeof e||void 0===e||\"function\"==typeof e&&\"\"===e.name},n=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).strict,r=void 0!==e&&e;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.strict=r,this.rules=new Map,this.policies=new Map,this.registry=new WeakMap}var n,i,o;return n=t,(i=[{key:\"rule\",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r(t)&&(i=void 0===t||t,t=\"GLOBAL_RULE\");var o=this.subjectMapper(t),a=Array.isArray(e)?e:[e];return a.forEach(function(e){var t=n.rules.get(o)||{};t[e]=i,n.rules.set(o,t)}),this}},{key:\"policy\",value:function(e,t){var r=\"function\"==typeof e?new e:e,n=this.subjectMapper(t);return this.policies.set(n,r),this}},{key:\"register\",value:function(e,t){return this.registry.set(e,t),this}},{key:\"can\",value:function(e,t,r){r=void 0===r?\"GLOBAL_RULE\":r;var n=this.subjectMapper(r),i=this.policies.get(n),o=i||this.rules.get(n);if(void 0===o){if(this.strict)throw new Error('Unknown subject \"'.concat(n,'\"'));return!1}for(var a=arguments.length,s=new Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];if(i&&\"function\"==typeof i.beforeAll){var c=i.beforeAll.apply(i,[t,e,r,n].concat(s));if(void 0!==c)return c}if(\"function\"==typeof o[t])return Boolean(o[t].apply(o,[e,r,n].concat(s)));if(this.strict&&void 0===o[t])throw new Error('Unknown verb \"'.concat(t,'\"'));return Boolean(o[t])}},{key:\"some\",value:function(e,t,r){for(var n=this,i=arguments.length,o=new Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];return r.some(function(r){return n.can.apply(n,[e,t,r].concat(o))})}},{key:\"every\",value:function(e,t,r){for(var n=this,i=arguments.length,o=new Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];return r.every(function(r){return n.can.apply(n,[e,t,r].concat(o))})}},{key:\"mixin\",value:function(e){var t=this;return e.prototype.can=function(){return t.can.apply(t,[this].concat(Array.prototype.slice.call(arguments)))},e.prototype.can.every=function(){return t.every.apply(t,[this].concat(Array.prototype.slice.call(arguments)))},e.prototype.can.some=function(){return t.some.apply(t,[this].concat(Array.prototype.slice.call(arguments)))},this}},{key:\"subjectMapper\",value:function(e){if(\"string\"==typeof e)return e;var t=\"function\"==typeof e;return t&&this.registry.has(e)?this.registry.get(e):!t&&this.registry.has(e.constructor)?this.registry.get(e.constructor):t?e.name:e.constructor.name}},{key:\"reset\",value:function(){return this.rules=new Map,this.policies=new Map,this.registry=new WeakMap,this}},{key:\"removeRules\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.subjectMapper(e);if(this.rules.has(r)){if(t){var n=this.rules.get(r);return delete n[t],this}this.rules.delete(r)}return this}},{key:\"removePolicy\",value:function(e){var t=this.subjectMapper(e);return this.policies.delete(t),this}},{key:\"removeAll\",value:function(e){return this.removeRules(e),this.removePolicy(e),this}}])&&e(n.prototype,i),o&&e(n,o),t}();export default n;export{t as GlobalRule};\n//# sourceMappingURL=browser-acl.esm.js.map\n","import Acl, { GlobalRule } from 'browser-acl'\n\n/**\n * VueAcl constructor function\n *\n * ```javascript\n * import Vue from 'vue'\n * import Acl from 'vue-browser-acl'\n *\n * Vue.use(Acl, user, (acl) => {\n *   acl.rule(view, Post)\n *   acl.rule([edit, delete], Post, (user, post) => post.userId === user.id)\n *   acl.rule('moderate', Post, (user) => user.isModerator())\n * })\n * ```\n *\n * @access public\n * @param {Function|Object} user A user instance or a function that returns the user\n * @param {Function|Object} setupCallback A configured Acl instance or a callback callback that adds rules and policies.\n * @param {Object}   options={}\n * @param {Object}  [options.acl={}] Options passed to the Acl constructor\n * @param {Boolean} [options.assumeGlobal=true] If no subject is specified in route assume it is a global rule\n * @param {Boolean} [options.caseMode=true] When true lower case subjects will be looked up on the vue context\n * @param {Boolean} [options.debug=false] Outputs errors and other useful information to the console\n * @param {Boolean} [options.directive='can'] Name of the directive, and helper function\n * @param {String}  [options.failRoute='/'] Set a default fail route\n * @param {Boolean} [options.helper=true] Adds helper function\n * @param {Boolean} [options.strict=false] Causes redirect to fail route if route permissions are absent\n * @param {?Object}  options.router Vue router\n */\nexport default {\n  install: function (Vue, user, setupCallback, options = {}) {\n    /* ensure userAccessor is function */\n    const userAccessor = typeof user === 'function' ? user : () => user\n\n    /* defaults */\n    const strict = Boolean(options.strict)\n    options = Object.assign(\n      {\n        acl: { strict },\n        assumeGlobal: !strict,\n        caseMode: true,\n        debug: false,\n        directive: 'can',\n        failRoute: '/',\n        helper: true,\n        strict: false,\n      },\n      options\n    )\n\n    /* setup acl */\n    let acl = setupCallback\n    if (typeof setupCallback === 'function') {\n      acl = new Acl(options.acl)\n      setupCallback(acl)\n    }\n\n    /* router init function */\n    acl.router = function (router) {\n      options.router = router\n\n      const canNavigate = (verb, subject, ...otherArgs) => {\n        return (subject && acl.can(userAccessor(), verb, subject, ...otherArgs)) ||\n          (!subject && !options.strict)\n      }\n\n      /* check for both can and role */\n      const getCan = meta => meta.can || meta.role\n\n      /* convert 'edit Post' to ['edit', 'Post'] */\n      const metaToStatementPair = meta => {\n        const [\n          verb = null,\n          subject = options.assumeGlobal ? GlobalRule : null\n        ] = (getCan(meta) || '').split(' ')\n        return [verb, subject]\n      }\n\n      /**\n       * chain all can-statements and functions as promises\n       * each can-function must return a promise (in strict\n       * mode at least). To break the chain return a none\n       * true value\n       */\n      const chainCans = (metas, to, from) => {\n        let fail = null\n        const chain = metas.reduce((chain, meta) => {\n          return chain\n            .then(result => {\n              if (result !== true) {\n                return result\n              }\n\n              fail = meta.fail\n\n              const can = getCan(meta)\n\n              const nextPromise = typeof can === 'function'\n                ? can(to, from, canNavigate)\n                : Promise.resolve(canNavigate(...metaToStatementPair(meta)))\n\n              if (options.strict && !(nextPromise instanceof Promise)) {\n                throw new Error('$route.meta.can must return a promise in strict mode')\n              }\n\n              return nextPromise\n            })\n            // convert errors to false\n            .catch(error => {\n              if (options.debug) {\n                console.error(error)\n              }\n              return false\n            })\n        }, Promise.resolve(true))\n        chain.getFail = () => fail\n        return chain\n      }\n\n      router.beforeEach((to, from, next) => {\n        const metas = to.matched\n          .filter(route => route.meta && getCan(route.meta))\n          .map(route => route.meta)\n\n        const chain = chainCans(metas, to, from)\n        chain.then(result => {\n          if (result === true) {\n            return next()\n          }\n          const fail = chain.getFail() === '$from'\n            ? from.path\n            : chain.getFail()\n          next(fail || options.failRoute)\n        })\n      })\n    }\n\n    /* init router */\n    if (options.router) {\n      acl.router(options.router)\n    }\n\n    /* create directive */\n    Vue.directive(options.directive, function(el, binding, vnode) {\n      const behaviour = binding.modifiers.disable ? 'disable' : 'hide'\n\n      let verb, verbArg, subject, params\n      verbArg = binding.arg\n      if (Array.isArray(binding.value) && binding.expression.startsWith('[')) {\n        [verb, subject, params] = binding.modifiers.global\n          ? arrayToGlobalExprTpl(binding)\n          : arrayToExprTpl(binding)\n      } else if (typeof binding.value === 'string') {\n        [verb, subject, params] = stringToExprTpl(binding, vnode, options)\n      } else if (verbArg && typeof binding.value === 'object') {\n        verb = verbArg\n        subject = binding.value\n        params = []\n      } else if (binding.value === undefined && !binding.modifiers.global && options.assumeGlobal) {\n        // Fall back to global if no value is provided\n        verb = verbArg\n        subject = GlobalRule\n        params = []\n      }\n\n      if (options.assumeGlobal && !subject) {\n        subject = GlobalRule\n        params = params || []\n        verb = verb || verbArg\n      }\n\n      if (!verb || !subject) {\n        throw new Error('Missing verb or subject')\n      }\n\n      const aclMethod =\n        (binding.modifiers.some && 'some') ||\n        (binding.modifiers.every && 'every') ||\n        'can'\n\n      const ok = acl[aclMethod](userAccessor(), verb, subject, ...params)\n      const not = binding.modifiers.not\n\n      el.disabled = false\n      el.readOnly = false\n      if ((ok && not) || (!ok && !not)) {\n        if (behaviour === 'hide') {\n          commentNode(el, vnode)\n        } else if (behaviour === 'disable') {\n          el.disabled = true\n        } else if (behaviour === 'readonly') {\n          el.readOnly = true\n        }\n      }\n    })\n\n    /* define helpers */\n    if (options.helper) {\n      const helper = `$${options.directive}`\n      Vue.prototype[helper] = function () {\n        return acl.can(userAccessor(), ...arguments)\n      }\n      Vue.prototype[helper].not = function () {\n        return !acl.can(userAccessor(), ...arguments)\n      }\n      Vue.prototype[helper].every = function () {\n        return acl.every(userAccessor(), ...arguments)\n      }\n      Vue.prototype[helper].some = function () {\n        return acl.some(userAccessor(), ...arguments)\n      }\n    }\n  }\n}\n\n/**\n * Create comment node\n *\n * @private\n * @author https://stackoverflow.com/questions/43003976/a-custom-directive-similar-to-v-if-in-vuejs#43543814\n */\nfunction commentNode(el, vnode) {\n  const comment = document.createComment(' ')\n\n  Object.defineProperty(comment, 'setAttribute', {\n    value: () => undefined\n  })\n\n  vnode.text = ' '\n  vnode.elm = comment\n  vnode.isComment = true\n  vnode.tag = undefined\n  vnode.data.directives = undefined\n\n  if (vnode.componentInstance) {\n    vnode.componentInstance.$el = comment\n  }\n\n  if (el.parentNode) {\n    el.parentNode.replaceChild(comment, el)\n  }\n}\n\n/**\n * Maps binding.value of type array to expression tuple\n */\nconst arrayToExprTpl = ({arg, value}) => ([\n  arg || value[0],\n  arg ? value[0] : value[1],\n  arg ? value.slice(1) : value.slice(2)\n])\n\n/**\n * Maps binding.value of type array to global expression tuple\n */\nconst arrayToGlobalExprTpl = ({arg, value}) => ([\n  arg || value[0],\n  GlobalRule,\n  arg ? value : value.slice(1)\n])\n\n/**\n * Maps binding.value of type string to expression tuple\n */\nconst stringToExprTpl = ({arg, value, modifiers}, vnode, options) => {\n  let [verb, subject] = arg ? [arg, value] : value.split(' ')\n\n  if (subject && modifiers.global) {\n    throw new Error('You cannot provide subject and use global modifier at the same time')\n  }\n\n  if (\n    typeof subject === 'string' &&\n    options.caseMode &&\n    subject[0].match(/[a-z]/)\n  ) {\n    subject = vnode.context[subject]\n  }\n\n  return [verb, subject, []]\n}\n"],"names":["e","t","r","length","n","enumerable","configurable","writable","Object","defineProperty","key","name","arguments","strict","TypeError","this","rules","Map","policies","registry","WeakMap","i","value","o","subjectMapper","a","Array","isArray","forEach","get","set","Error","concat","s","u","beforeAll","c","apply","Boolean","some","can","every","prototype","slice","call","has","constructor","delete","removeRules","removePolicy","install","Vue","user","setupCallback","options","userAccessor","assign","acl","assumeGlobal","caseMode","debug","directive","failRoute","helper","Acl","router","canNavigate","verb","subject","otherArgs","getCan","meta","role","chainCans","metas","to","from","fail","chain","reduce","then","result","nextPromise","Promise","resolve","GlobalRule","split","metaToStatementPair","catch","error","console","getFail","beforeEach","next","matched","filter","route","map","path","el","binding","vnode","behaviour","modifiers","disable","verbArg","params","arg","expression","startsWith","global","arrayToGlobalExprTpl","arrayToExprTpl","stringToExprTpl","undefined","aclMethod","ok","not","disabled","readOnly","commentNode","comment","document","createComment","text","elm","isComment","tag","data","directives","componentInstance","$el","parentNode","replaceChild","match","context"],"mappings":"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"}